\section{Executive summary}
\label{sec:exec}

\subsection{Target}

This analysis uses an innovative machine learning method~\cite{1911.09107} to perform an unbinned, variable- and high-dimensional unfolding using $Z$+jets events. As the first analysis using these new techniques, we limit the phase space to relatively high \pt{} $Z$~bosons in the $Z\to\mu\mu$ channel.   The analysis is broken into two parts, each a significant innovation.  A first round will consider the case of a fixed (but large) number of observables to be simultaneously unfolded (MultiFold).  This first part targets summer/fall 2021.  A second round will consider all charged particles (OmniFold) and targets end of 2021/early 2022.

These data can be used for a variety of studies of Quantum Chromodynamics (QCD), including precision constraints of perturbative QCD, studies of fragmentation, and Monte Carlo event tuning.  New observables that can be constructed with the unfolded phase space can be studied after the measurement and with whatever binning is most natural for the downstream analysis.  This includes complex observables that cannot be unfolded using standard techniques such as the correlation dimension~\cite{Komiske:2019fks} (in the case of OmniFold).

\subsection{Context}

While there is no other measurement that is unbinned, variable- and high-dimensional, there are a variety of related binned measurements of specific observables.   These include track-based observables in inclusive $Z$+jets events at $\sqrt{s}=\SI{8}{\TeV}$~\cite{STDM-2015-14} and various measurements of hadronic final states using tracks~\cite{STDM-2018-57,STDM-2017-33,STDM-2017-16}.  None of these measurements are directly comparable to the one presented in this analysis because of the topology and/or the phase space.  However, as we are using a new methodology for the first time, one of the goals of this paper is to compare the method with standard techniques (e.g.\ Iterative Bayesian Unfolding~\cite{DAGOSTINI1995487,1974AJ.....79..745L,Richardson:72}) in addition to presenting the new unbinned data.

\subsection{Contributors}

\PrintAtlasContribute{0.30}

\clearpage

\input{changelog}

\clearpage

\part{Common Components}
\label{part:common}

\textit{All of the sections in this Part are common between the MultiFold and OmniFold analyses.}

%-------------------------------------------------------------------------------
\section{Introduction}
\label{sec:intro}
%-------------------------------------------------------------------------------

High energy scattering at the Large Hadron Collider is a powerful tool for studying the emergent properties of the strong force.  A particularly prominent emergent feature of Quantum Chromodynamics (QCD) is jets: collimated sprays of particles.  The kinematic and substructure properties of jets can be used for a variety of purposes, including tests of perturbation theory and factorization, as well as fitting parameters in Parton Shower Monte Carlo calculations~\cite{Larkoski:2017jix,Kogler:2018hem}.  The hadronic recoil in events produces with a $Z$ boson are particularly useful because leptonic $Z$ decays can be identified with high purity and efficiency, introducing little bias on jet properties from the event selection.  Furthermore, the $Z$+jets cross section is known more precisely than the multijet cross section.  For example, the jet mass differential cross section has been calculated in resummed perturbation theory~\cite{Kang:2018jwa,Dasgupta:2012hg,Chien:2012ur} and a matching onto fixed-order perturbation theory is most precise in the $Z$+jets final state since a non-trivial jet mass is already produced at next-to-leading order in the strong coupling constant ($\mathcal{O}(\alpha_s^2)$) as opposed to $\mathcal{O}(\alpha_s^3)$ in dijet events~\cite{Frye:2016okc,Frye:2016aiz}.  

Probing the hadronic recoil in $Z$+jets events is challenging because of its complex structure.  There have been many binned differential cross section measurements of jet substructure in $Z$ boson events from proton collisions by ATLAS~\cite{ATLAS:2017arb}, CMS~\cite{CMS:2013kfv,CMS:2021iwu}, and LHCb~\cite{LHCb:2019qoc}.  These measurements use various \textit{unfolding} methods for correcting for detector effects to faciiliate comparisons with predictions and across experiments. 
%The goal of the Large Hadron Collider (LHC) is to infer properties of nature at subnuclear length scales.   One strategy for data analysis is to use models like the Standard Model (SM) and its extensions to fit parameter values to data.  This is an effective strategy that has been used to measure Standard Model couplings and masses as well as to constrain the strength of new physics extensions of the SM.  A key limitation of this parametric approach is that the final result cannot be easily used to infer properties of other parameters or reinterpreted in the context of a different model.  An alternative strategy is to correct data for detector effects in order to measure differential cross sections.  These \textit{unfolded} spectra can be reused for a variety of model interpretations.   Unfolding facilitates data preservation for reuse over time and comparisons across experiments.
The most widely used unfolding methods use various forms of regularized matrix inversion~\cite{DAGOSTINI1995487,Hocker:1995kb,Schmitt:2012kp}.  There are four challenges with these approaches that limit their usefulness.   First, the target observables must be specified prior to unfolding and cannot be changed after the measurement.  Similarly, the binning of the observables must be fixed at the start of the measurement.  Due to the binned nature of existing techniques, most measurements are limited to a small number of observables (usually one) to be simultaneously unfolded.  Finally, the existing methods are not able to account for auxiliary features that determine the resolution of the target observables and thus limit the precision of the measurement.

A variety of alternative unfolding methods have been proposed to solve a subset of these challenges.   For example, some proposals avoid binning~\cite{Glazov:2017vni,Datta:2018mwd,Lindemann:1995ut,Aslan:2003vu} and others use machine learning to improve various aspects of the measurement precision~\cite{Gagunashvili:2010zw,Glazov:2017vni,Datta:2018mwd}.  Recently, three techniques have been proposed that have the potential to address all of the above challenges: OmniFold~\cite{1911.09107}, Conditional GAN Unfolding (CGU)~\cite{Bellagente:2019uyp}, and Conditional Normalizing Flow Unfolding (CNFU)~\cite{Bellagente:2020piv}.   The OmniFold approach scaffolds a simulation with a neural network to perform high- and variable-dimensional reweighting.  The CGU and CNFU methods use neural networks to generate corrected events given detector-level events.

This analysis uses the OmniFold approach to perform the first high- and variable-dimensional unbinned measurement.  In contrast to the CGU and CNFU methods, OmniFold can naturally account for point-cloud nature of collider events (by using e.g. Particle Flow Networks~\cite{Komiske:2018cqr}).  Furthermore, OmniFold reduces to the widely studied Iterative Bayesian Unfolding approach~\cite{DAGOSTINI1995487} when the inputs are binned.  Finally, by using reweighting instead of direct generative modeling, the neural networks need to only learn small corrections to the simulation instead of learning the full probability density of the data.   Charged particles are used due to the precision with which they can be measured.  Even though charged-particle spectra are not known theoretically as precisely as all-particle spectra, here has been significant recent theoretical progress in precision calculations for this configuration~\cite{Chang:2013rca,Chang:2013iba,Li:2021zcf}.  $Z$+jets events have many tens of charged particles each with a momentum and electric charge and thus the full phase space is about 100-dimensional.  A first round (MultiFold) of the analysis uses a large (but fixed) number of observables related to the $Z$ kinematic properties as well as the kinematic and substructure of the leading jets.  A second round (OmniFold) will target the full high- and variable-dimensional phase space defined by all charged particles.   For MultiFold, the observables are chosen to probe a variety of physical effects.  There is a significant overlap in observables between the MultiFold analysis and the ones used to produce the widely-used ATLAS A14 tune~\cite{ATL-PHYS-PUB-2014-021}.  Note that unlike the A14 inputs, the MultiFold analysis includes all observables simultaneously, whereas in A14, the different measurements were combined in an \textit{ad hoc} approach. 

%The hadronic recoil in $Z$+jets events can be used for a variety of purposes.  Jet substructure has been used extensively for Parton Shower Monte Carlo tuning.  The ATLAS A14 tune~\cite{ATL-PHYS-PUB-2014-021} is widely used and the final state shower parameters were tuned using various jet substructure observables.  There is a significant overlap in observables between the MultiFold analysis and the A14 inputs.  Note that unlike the A14 inputs, the MultiFold analysis includes all observables simultaneously, whereas in A14, the different measurements were combined in an \textit{ad hoc} approach.   In addition to model tuning, the $Z$+jets final state is also of interest for precision studies of Quantum Chromodynamics (QCD).  For example, the jet mass distribution is known most precisely in $Z$+jets events~\cite{Frye:2016okc,Frye:2016aiz} because a non-trivial jet mass is already produced at order $\mathcal{O}(\alpha_s^2)$.  In contrast, the jet mass in dijet events requires $\mathcal{O}(\alpha_s^3)$.  While we only focus on the charged-particle final state, there has been significant recent theoretical progress in precision calculations for this configuration~\cite{Chang:2013rca,Chang:2013iba,Li:2021zcf}. 

This note is organized as follows.  First, Sec.~\ref{sec:samples} introduces the data and simulated event samples used for the analysis.  Then, Sec.~\ref{sec:objects} describes the objects used in the analysis (in particular, charged particles and tracks).  The analysis methodology is disucssed in Sec.~\ref{sec:strategy} and the prescription for systematic uncertainties appears in Sec.~\ref{sec:uncerts}.  Results are presented in Sec.~\ref{sec:resultsMulti} and Sec.~\ref{sec:resultsOmni} for Multifold and OmniFold respectively, and the note concludes in Sec.~\ref{sec:conclusion}.
